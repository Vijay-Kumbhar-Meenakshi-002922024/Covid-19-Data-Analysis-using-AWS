{
	"jobConfig": {
		"name": "s3_glue_covid_data",
		"description": "",
		"role": "arn:aws:iam::591034249457:role/s3-glue-role",
		"command": "pythonshell",
		"version": "3.0",
		"runtime": null,
		"workerType": null,
		"numberOfWorkers": null,
		"maxCapacity": 0.0625,
		"maxRetries": 0,
		"timeout": 2880,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "s3_glue_covid_data.py",
		"scriptLocation": "s3://aws-glue-assets-591034249457-us-east-1/scripts/",
		"language": "python-3.9",
		"jobParameters": [],
		"tags": [],
		"jobMode": "DEVELOPER_MODE",
		"createdOn": "2023-05-25T15:23:59.349Z",
		"developerMode": true,
		"connectionsList": [],
		"temporaryDirectory": "s3://meenakshi-test-bucket/output/",
		"glueHiveMetastore": true,
		"etlAutoTuning": false,
		"pythonPath": "s3://meenakshi-test-bucket/packages/redshift_connector-2.0.910-py3-none-any.whl",
		"pythonShellPrebuiltLibraryOption": "analytics",
		"flexExecution": false,
		"minFlexWorkers": null
	},
	"hasBeenSaved": false,
	"script": "import redshift_connector\r\n\r\nconn = redshift_connector.connect(\r\n    host='redshift-cluster-1.cdoeoearcpxt.us-east-1.redshift.amazonaws.com',\r\n    port=5439,\r\n    database='dev',\r\n    user='awsuser',\r\n    password='Meenakshi1',\r\n    timeout=120\r\n)\r\n\r\nconn.autocommit = True\r\n\r\ncursor = redshift_connector.Cursor = conn.cursor()\r\n\r\ncursor.execute(\"\"\"\r\nCREATE TABLE \"dim_date\" (\r\n\"fips\" REAL,\r\n  \"date\" TIMESTAMP,\r\n  \"year\" INTEGER,\r\n  \"month\" INTEGER,\r\n  \"dayOfWeek\" INTEGER\r\n)\r\n\"\"\")\r\n\r\n\r\ncursor.execute(\"\"\"\r\nCREATE TABLE \"dim_hospital\" (\r\n\"fips\" INTEGER,\r\n  \"state_name\" TEXT,\r\n  \"latitude\" REAL,\r\n  \"longtitude\" REAL,\r\n  \"hq_address\" TEXT,\r\n  \"hospital_name\" TEXT,\r\n  \"hospital_type\" TEXT,\r\n  \"hq_city\" TEXT,\r\n  \"hq_state\" TEXT\r\n)\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\nCREATE TABLE \"factCovid\" (\r\n\"fips\" REAL,\r\n  \"province_state\" TEXT,\r\n  \"country_region\" TEXT,\r\n  \"confirmed\" REAL,\r\n  \"deaths\" REAL,\r\n  \"recovered\" REAL,\r\n  \"active\" REAL,\r\n  \"date\" INTEGER,\r\n  \"positive\" INTEGER,\r\n  \"negative\" REAL,\r\n  \"hospitalizedcurrently\" REAL,\r\n  \"hospitalized\" REAL,\r\n  \"hospitalizeddischarged\" REAL\r\n)\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\nCREATE TABLE \"dimRegion\" (\r\n\"fips\" REAL,\r\n  \"province_state\" TEXT,\r\n  \"country_region\" TEXT,\r\n  \"latitude\" REAL,\r\n  \"longitude\" REAL,\r\n  \"county\" TEXT,\r\n  \"state\" TEXT\r\n)\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\ncopy dim_date from 's3://meenakshi-test-bucket/output/dim_date.csv'\r\nCREDENTIALS 'aws_iam_role=arn:aws:iam::591034249457:role/service-role/AmazonRedshift-CommandsAccessRole-20230525T105017'\r\ndelimiter ','\r\nregion 'us-east-1'\r\nIGNOREHEADER 1\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\ncopy dimregion from 's3://meenakshi-test-bucket/output/dimRegion.csv'\r\nCREDENTIALS 'aws_iam_role=arn:aws:iam::591034249457:role/service-role/AmazonRedshift-CommandsAccessRole-20230525T105017'\r\ndelimiter ','\r\nregion 'us-east-1'\r\nIGNOREHEADER 1\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\ncopy dim_hospital from 's3://meenakshi-test-bucket/output/dim_hospital.csv'\r\nCREDENTIALS 'aws_iam_role=arn:aws:iam::591034249457:role/service-role/AmazonRedshift-CommandsAccessRole-20230525T105017'\r\ndelimiter ','\r\nregion 'us-east-1'\r\nIGNOREHEADER 1\r\n\"\"\")\r\n\r\ncursor.execute(\"\"\"\r\ncopy factCovid from 's3://meenakshi-test-bucket/output/factCovid.csv'\r\nCREDENTIALS 'aws_iam_role=arn:aws:iam::591034249457:role/service-role/AmazonRedshift-CommandsAccessRole-20230525T105017'\r\ndelimiter ','\r\nregion 'us-east-1'\r\nIGNOREHEADER 1\r\n\"\"\")\r\n\r\n\r\n\r\n\r\n"
}